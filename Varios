SELECT 
    se.state_entity_id,
    s.state_name,
    COUNT(sw.stage_work_id) AS stage_works_asociados
FROM dbo.state_entities se
INNER JOIN dbo.entities e ON e.entity_id = se.entity_id
INNER JOIN dbo.states s ON se.state_id = s.state_id
LEFT JOIN dbo.stage_works sw ON se.state_entity_id = sw.state_entity_id
WHERE e.entity_name = 'Stage' AND s.state_name = 'Certificaci√≥n'
GROUP BY se.state_entity_id, s.state_name
